<!DOCTYPE html>
<html>

<head>
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;0,500;0,600;0,700;1,300&display=swap");

    @font-face {
      font-family: Logo-font;
      src: url("/public/fonts/MontserratAlt1-Medium.woff2");
    }

    .logo {
      font-family: Logo-font;
      font-size: 30px;
    }

    body,
    html {
      font-family: Poppins, sans-serif;
    }
  </style>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>

<body>
  <div class="container">
    <div class="logo">BE.SKY</div>
    <div class="d-flex flex-column align-items-center">
      <strong style="font-size: 40px;">SALES REPORT</strong>
      <p class="m-0">From <%= startDate.toLocaleDateString() %> to <%= endDate.toLocaleDateString() %>
      </p>
    </div>

    <div class="summary">
      <p>Revenue: $<%= salesReport.totalSalesAmount %>
      </p>
      <p>Discount: $<%= salesReport.totalDiscounts %>
      </p>
      <p>Orders: <%= salesReport.totalOrders %>
      </p>
      <p>Shipping Charge: $<%= salesReport.totalShipping %>
      </p>
    </div>

    <h3>Order Details</h3>
    <table>
      <tr>
        <th>Date</th>
        <th>Order ID</th>
        <th>No of items</th>
        <th>Payment Method and Status</th>
        <th>Grand Total</th>
      </tr>
      <% orders.forEach(order=> { %>
        <tr>
          <td>
            <%= new Date(order.createdAt).toLocaleDateString() %>
          </td>
          <td>
            <%= order._id %>
          </td>
          <td>
            <%= order.items.length %>
          </td>
          <td>
            <%= order.paymentMethod %> - <%= order.paymentStatus %>
          </td>
          <td>$<%= order.grandTotal %>
          </td>
        </tr>
        <% }) %>
    </table>
  </div>
</body>

</html>